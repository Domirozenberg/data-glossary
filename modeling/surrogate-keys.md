# Surrogate Keys

## Overview
A surrogate key is a system-generated, unique identifier assigned to each row in a table, with no business meaning. It is used in data warehousing and dimensional modeling to provide stable, immutable keys for dimensions and facts, independent of source system changes, and to support slowly changing dimensions (SCD) and consistent joins across systems.

## Definition
A surrogate key is a primary key that is not derived from business data. It is typically an integer or UUID generated by the data pipeline (e.g., sequence, auto-increment, or hash). Dimension tables use surrogate keys as primary keys; fact tables store surrogate keys as foreign keys to dimensions. Business identifiers (natural keys) are kept as attributes in the dimension but are not used as the primary join key in the warehouse.

## Key Concepts

- **No Business Meaning**: Value has no semantic content; used only for uniqueness and joins
- **Stability**: Does not change when business attributes change; supports SCD Type 2 (new row gets new surrogate key)
- **Uniqueness**: Guaranteed unique within the table (and often globally) to avoid key collisions across sources
- **Consistency**: Same surrogate key used everywhere for the same dimension member in the warehouse
- **Generation**: Created by ETL (sequence, identity, UUID, or hash of natural key + version)
- **Natural Key**: Business key is still stored and used for matching incoming data to existing dimension rows

## How It Works

Surrogate key usage:

1. **Dimension Load**: When a new dimension member arrives (by natural key), generate a new surrogate key and insert row. When an existing member is updated (e.g., SCD Type 2), generate a new surrogate key for the new row; keep natural key for lookup.
2. **Fact Load**: Look up dimension surrogate key by matching natural key (and optionally effective date for Type 2); store surrogate key in fact table. Facts never store natural key as the dimension reference for joins.
3. **Joins**: All fact-to-dimension joins use surrogate key; no dependency on source system key format or changes
4. **Cross-System**: Different sources may use different natural keys for the same entity; warehouse assigns one surrogate key per entity (after deduplication and matching)

Generation options:
- **Sequence/Identity**: Auto-increment integer; simple and compact
- **UUID**: Globally unique; good for distributed generation; larger
- **Hash**: Hash of natural key (and perhaps version) for deterministic generation; watch for collision handling
- **Composite**: Rarely; usually single column for simplicity

## Use Cases

- **Dimensional Modeling**: Standard practice for dimension primary keys and fact foreign keys in star/snowflake schemas
- **SCD Type 2**: New dimension row gets new surrogate key so historical facts retain correct historical dimension reference
- **Multi-Source Integration**: Multiple sources with different natural keys map to one surrogate key per entity
- **Source Key Changes**: When source system changes or reuses natural keys, warehouse keys remain stable
- **Performance**: Integer surrogate keys are small and fast for joins and indexes

## Considerations

- **No Semantic Use**: Surrogate key should not be used for ordering or business logic; use attributes or natural key for that
- **Generation Responsibility**: ETL must own key generation; ensure no duplicates and consistent assignment
- **Reconciliation**: Auditing and reconciliation to source use natural key; surrogate is for internal warehouse use
- **Lookup Performance**: Dimension lookup by natural key (to get surrogate for fact load) must be efficient (index, cache)
- **Rebuilding**: If dimension is rebuilt, surrogate keys may change unless generation is deterministic (e.g., hash); facts may need to be refreshed or key mapping maintained

## Best Practices

- **Use in All Dimensions**: Use surrogate key as primary key for every dimension table in the warehouse
- **Store Natural Key**: Keep natural key as attribute for ETL matching and audit
- **Document Generation**: Document how surrogate key is generated (sequence name, hash inputs, etc.)
- **Index Natural Key**: Index dimension on natural key (and effective date if Type 2) for fast lookup during fact load
- **Never Reuse**: Do not reuse surrogate key values for deleted or obsolete rows if facts still reference them

## Related Topics

- Natural Keys
- Composite Keys
- Dimension Tables
- Fact Tables
- Slowly Changing Dimensions (SCD)
- Dimensional Modeling

---

**Category**: Data Modeling  
**Last Updated**: 2024
